const postesData = {
  conducteurs_tp: {
    risques: [
      "Circulation en engins TP",
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Produits chimiques"
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1qLUXU6CCyFPBT8XaOwsO7c4PyYODJOZX/view?usp=sharing",
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },

  equipements_fluviaux: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Produits chimiques"
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },

  marinier: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risques de chute de plain-pied",
      "Risques de chute de hauteur / Ã©chelle",
      "Produits chimiques"
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1VE5L7Gvyn78Vemqmk1u9BmwGxbA1GY45/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },

  chauffeur_pl: {
    risques: [
      "Circulation en engins TP",
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Risques de chute de hauteur",
      "Produits chimiques"
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1qLUXU6CCyFPBT8XaOwsO7c4PyYODJOZX/view?usp=sharing",
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
         "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1VE5L7Gvyn78Vemqmk1u9BmwGxbA1GY45/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },
  mecanicien: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI Atelier",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Risque de chute de hauteur",
      "Produits chimiques",
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1uZZinRZaQm3OeaIgJ8Fvsv9l5eIeZ7ZK/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/drive/u/0/folders/1R12LmzuZ4eiM49GgU-CM3Jz-gfEWel_O",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },
  soudeur: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI Atelier",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Risque de chute de hauteur",
      "Produits chimiques",
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1uZZinRZaQm3OeaIgJ8Fvsv9l5eIeZ7ZK/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1VE5L7Gvyn78Vemqmk1u9BmwGxbA1GY45/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },
  travaux_forestiers: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risques de chute de plain-pied",
      "Risque de chute de hauteur",
      "Produits chimiques",
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
         "https://drive.google.com/file/d/1VE5L7Gvyn78Vemqmk1u9BmwGxbA1GY45/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },
    operateurs_polyvalents: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Produits chimiques"
    ], 
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },  
  intervenant_bathy_topo: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque routier"
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1JKU6LBprdTohn6skSbjIZmzzrz7EvT_r/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
     ]
  },
    intervenant_tereos: {
    risques: [
      "CoactivitÃ© Engins PiÃ©tons",
      "Protection de lâ€™environnement",
      "Port des EPI",
      "Intervention mÃ©canique",
      "Manutention manuelle",
      "Risque de chute Ã  lâ€™eau et noyade",
      "OpÃ©rations de levage mÃ©canique",
      "RÃ©flÃ©chir avant dâ€™agir",
      "Ordre et propretÃ© sur le chantier",
      "Risque Ã©lectrique",
      "Risque routier",
      "Risques de chute de plain-pied",
      "Risque de chute de hauteur",
      "Produits chimiques",
    ],
    liens_risques: [
        "https://drive.google.com/file/d/1qLUXU6CCyFPBT8XaOwsO7c4PyYODJOZX/view?usp=sharing",
        "https://drive.google.com/file/d/1DBPO7mfxCmkvZawg7sNMEWgXJy4PncR4/view?usp=sharing",
        "https://drive.google.com/file/d/1hu1PNgKcqQ1NAxUHwcWxN110TDRUI0KZ/view?usp=sharing",
        "https://drive.google.com/file/d/1cI-rlmi2i_2FmWz86reCvQaTHtePzVey/view?usp=sharing",
        "https://drive.google.com/file/d/1ebwKR8j60VtknFrSdI4DEBL8px6j4OVg/view?usp=sharing",
        "https://drive.google.com/file/d/11wL2sls-LP16aoPUNBUez4XetiGoXId6/view?usp=sharing",
        "https://drive.google.com/file/d/1EeGMIMXifFvLo_hdQJWGtHAsclSHt1L7/view?usp=sharing",
        "https://drive.google.com/file/d/1UCVoKFOCAWaA06i3PAL_Cj5MaWSN7Oap/view?usp=sharing",
        "https://drive.google.com/file/d/1Y-FnuDuhVnpzgkeZkMEuR3xotL98J1Js/view?usp=sharing",
        "https://drive.google.com/file/d/1GYqgxv6KBUklmYz_1yFvjY_bJ-Y0A5JS/view?usp=sharing",
        "https://drive.google.com/file/d/1iOf0cTWyqP5RO0V1cgqeZYsO3EXHQnlp/view?usp=sharing",
        "https://drive.google.com/file/d/1uMsPMhV8T8zeBCRE2KOx1L_T9G3WPUv6/view?usp=sharing",
        "https://drive.google.com/file/d/1VE5L7Gvyn78Vemqmk1u9BmwGxbA1GY45/view?usp=sharing",
        "https://drive.google.com/file/d/1GrUQKpcUnmbt7W5xtJx5GzdQ_dKn4ypZ/view?usp=sharing"
    ]
  },
};

// Renvoie le nom complet du poste
function getPosteName(key) {
  const map = {
    conducteurs_tp: "Conducteurs dâ€™engins TP",
    equipements_fluviaux: "Conducteurs Ã©quipements fluviaux / maritime",
    marinier: "Marinier / Conducteur de Bateaux Freycinet",
    chauffeur_pl: "Chauffeur PL / Utilisateur de grue auxiliaire",
    mecanicien: "MÃ©canicien",
    soudeur:"Soudeur",
    travaux_forestiers: "Travaux forestiers",
    operateurs_polyvalents:"OpÃ©rateurs polyvalents",
    intervenant_bathy_topo:"Intervenant Cellule Bathy / Topo",
    intervenant_tereos:"Intervenant TEREOS"
  };
  return map[key] || key;
}

function createTable(posteKey, container) {
const posteNom = getPosteName(posteKey);
  const poste = postesData[posteKey];
  if (!poste) return;

  const table = document.createElement("table");
  table.classList.add("risques-table");

  // En-tÃªtes
  const header = table.createTHead();
  const headerRow = header.insertRow();
  ["Poste de travail", "Fiche de risque"].forEach(text => {
    const th = document.createElement("th");
    th.textContent = text;
    headerRow.appendChild(th);
  });

  // Corps du tableau
  const tbody = table.createTBody();

for (let i = 0; i < poste.risques.length; i++) {
  const row = tbody.insertRow();

  // PremiÃ¨re ligne â†’ cellule "Poste" avec rowSpan
  if (i === 0) {
    const cellPoste = row.insertCell(0);
    cellPoste.textContent = posteNom;
    cellPoste.rowSpan = poste.risques.length; // fusion sur toutes les lignes
  }

  // Colonne "Fiches de postes" (checkbox + lien Drive)
  const cellFiche = row.insertCell(-1);

  // CrÃ©e la checkbox
  const checkbox = document.createElement("input");
  checkbox.type = "checkbox";
  checkbox.style.marginRight = "8px";

  // CrÃ©e le lien
  const lien = document.createElement("a");
  lien.href = poste.liens_risques[i];
  lien.textContent = poste.risques[i];
  lien.target = "_blank";
  lien.style.textDecoration = "none"; // pas de soulignement
  lien.style.color = "black"; // texte noir

  // Ajoute les deux dans la cellule
  cellFiche.appendChild(checkbox);
  cellFiche.appendChild(lien);
}
  container.appendChild(table);
}
document.addEventListener("DOMContentLoaded", () => {
  const postesContainer = document.getElementById("postes-container");
  const addBtn = document.getElementById("add-poste");
  let posteCount = 1;

  // Gestion du premier select
  document.querySelector(".poste-select").addEventListener("change", function () {
    const tableContainer = this.parentElement.querySelector(".table-container");
    tableContainer.innerHTML = "";
    if (this.value) createTable(this.value, tableContainer);
  });

  // Bouton "ajouter un poste"
  addBtn.addEventListener("click", () => {
    if (posteCount >= 3) {
      alert("Vous pouvez ajouter jusquâ€™Ã  3 postes maximum.");
      return;
    }

    const newBlock = document.createElement("div");
    newBlock.classList.add("poste-block");
    newBlock.innerHTML = `
      <label><b>Poste de Travail :</b></label>
      <select class="poste-select">
        <option value="">-- SÃ©lectionner un poste --</option>
        <option value="conducteurs_tp">Conducteurs dâ€™engins TP</option>
        <option value="equipements_fluviaux">Conducteurs Ã©quipements fluviaux / maritime</option>
        <option value="marinier">Marinier / Conducteur de Bateaux Freycinet</option>
        <option value="chauffeur_pl">Chauffeur PL / Utilisateur de grue auxiliaire</option>
        <option value="mecanicien">MÃ©canicien</option>
        <option value="soudeur">Soudeur</option>
        <option value="travaux_forestiers">Travaux forestiers</option>
        <option value="operateurs_polyvalents">OpÃ©rateurs polyvalents</option>
        <option value="intervenant_bathy_topo">Intervenant Cellule Bathy / Topo</option>
        <option value="intervenant_tereos">Intervenant TEREOS</option>
      </select>
      <div class="table-container"></div>
    `;

    // ðŸ‘‰ InsÃ¨re juste aprÃ¨s le prÃ©cÃ©dent select, pas aprÃ¨s le tableau
    const lastSelect = postesContainer.querySelector(".poste-block:last-of-type .poste-select");
    lastSelect.parentNode.insertAdjacentElement("afterend", newBlock);

    // Active lâ€™Ã©vÃ©nement sur le nouveau select
    newBlock.querySelector(".poste-select").addEventListener("change", function () {
      const tableContainer = this.parentElement.querySelector(".table-container");
      tableContainer.innerHTML = "";
      if (this.value) createTable(this.value, tableContainer);
    });

    posteCount++;
  });
});


function setupCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    canvas.width = canvas.parentElement.clientWidth;
    canvas.height = canvas.parentElement.clientHeight;

    let painting = false;

    function startPosition(e) {
      painting = true;
      draw(e);
      e.preventDefault(); // EmpÃªche le comportement par dÃ©faut
    }

    function endPosition(e) {
      painting = false;
      ctx.beginPath();
      e.preventDefault(); // EmpÃªche le comportement par dÃ©faut
    }

    function draw(e) {
      if (!painting) return;
      const rect = canvas.getBoundingClientRect();
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';

      let clientX, clientY;
      if (e.touches && e.touches.length > 0) {
        // Utiliser les coordonnÃ©es du premier touch point
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      } else {
        // Utiliser les coordonnÃ©es de la souris
        clientX = e.clientX;
        clientY = e.clientY;
      }

      ctx.lineTo(clientX - rect.left, clientY - rect.top);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(clientX - rect.left, clientY - rect.top);
      e.preventDefault(); // EmpÃªche le comportement par dÃ©faut
    }

    // Ajouter des Ã©couteurs pour les Ã©vÃ©nements de souris
    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', endPosition);
    canvas.addEventListener('mouseout', endPosition);
    canvas.addEventListener('mousemove', draw);

    // Ajouter des Ã©couteurs pour les Ã©vÃ©nements tactiles
    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', endPosition);
    canvas.addEventListener('touchcancel', endPosition);
    canvas.addEventListener('touchmove', draw);
  }

  // Initialisation
  setupCanvas('drawingCanvas1');

  // Bouton pour effacer
  function clearCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  
   function savePageContent() {
        const page = document.querySelector('#page4');
        const inputs = page.querySelectorAll('input, textarea, select');
        inputs.forEach(input => {
            if (input.type === 'checkbox' || input.type === 'radio') {
                if (input.checked) {
                    input.setAttribute('checked', 'checked');
                } else {
                    input.removeAttribute('checked');
                }
            } else {
                input.setAttribute('value', input.value);
            }
        });
        localStorage.setItem('page4Content', document.querySelector('#page4').outerHTML);
    }

    function loadPageContent() {
        // Restaurer le contenu HTML de la page avec les valeurs des champs
        const savedContent = localStorage.getItem('page4Content');
        if (savedContent) {
            document.querySelector('#page4').outerHTML = savedContent;
        }
    }

    function redirectToSignPage() {
        savePageContent();
        window.location.href = 'sign.html';
    }

    window.onload = function () {
        loadPageContent();
    }

    window.onbeforeunload = function () {
        savePageContent();
    }