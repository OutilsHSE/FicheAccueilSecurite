<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche d'Accueil S√©curit√©</title>
    <link rel="stylesheet" href="global.css">
    <style>
        table td {
            text-align: left;
            vertical-align: top;
            /* optionnel : aligne le texte en haut */
            padding: 5px 10px;
        }

        table td:has(input[type="checkbox"]) {
            text-align: center;
            vertical-align: middle;
        }
/* Met l‚Äôimage et le bloc texte c√¥te √† c√¥te */
.attestation td {
  display: flex;
  align-items: flex-start; /* aligne en haut */
  gap: 10px;              /* espace entre image et texte */
}

/* Image */
.attestation td img {
  max-width: 120px;
  height: auto;
}

/* Bloc texte */
.attestation .texte {
  display: flex;
  flex-direction: column; /* tout sous l‚Äôautre */
  text-align: left;       /* force l‚Äôalignement √† gauche */
  gap: 5px;               /* petit espace entre lignes */
}

/* Chaque sous-div prend toute la largeur */
.attestation .texte div {
  display: flex;
  align-items: flex-start; /* case + label align√©s en haut */
  gap: 5px;
}
/* met les deux blocs sur la m√™me ligne */
.form-et-cadre {
  padding: 15px;  
  display: flex;
  gap: 5px;              /* espace entre textarea et cadre */
  align-items: flex-start; /* alignement en haut */
}

/* que la textarea prenne toute la largeur possible */
.form-et-cadre .bloc-textarea {
  display: flex;
  flex-direction: column;
}
.form-et-cadre .bloc-textarea textarea {
  width: 500px;     /* prend toute la largeur du bloc */
  height: 375px;   /* fixe la hauteur si tu veux aussi */
}



/* responsive : en dessous de 768px, on repasse en colonne */
@media (max-width: 768px) {
  .form-et-cadre {
    flex-direction: column;
  }
}
.taches .tables-wrapper {
  display: flex;
  gap: 40px; /* espace entre les deux tableaux */
  align-items: flex-start; /* aligne en haut */
}

.taches table {
  border-collapse: collapse;
  width: 100%;
}

@media (min-width: 1370px) {
.sign {
    margin-left: 350px;
}
}



    </style>
</head>

<body>

    <div class="container">
        <img class="logo" src="CDES_Logo.png" alt="">
        <h1> Fiche d'Accueil S√©curit√© </h1>
    </div>
    <div id="page2">
        <table>
            <thead>
                <tr>
                    <th>
                        AUTORISATIONS DE TRAVAIL
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="red-text">
                    <td>
                        Pour les t√¢ches ci-dessous, il est strictement interdit d‚Äôeffectuer ces interventions sans
                        habilitation et/ou sans
                        formation trac√©e et en cours de validit√©. Checker les preuves de formation en amont, et
                        renseigner
                        l‚Äôautorisation de conduite obligatoire pour toutes activit√©s de conduite d‚Äôengins.
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="taches page-break">
             <div class="tables-wrapper">
            <table class="table-left">
                <thead>
                <tr>
                    <th>Conduite d'√©quipements de manutention</th>
                    <th>T√¢che autoris√©e par CDES</th>
                    <th>Preuve de formation valid√©</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Engins de chantier TP / Formation CACES R 482 => <span class="bold"> Engins compacts de moins de
                            6t (CACES A) </span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Engins de chantier TP / Formation CACES R 482 => <span class="bold">Pelles m√©caniques > 6t
                            (CACES B1) </span> </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Engins de chantier TP / Formation CACES R 482 => <span class="bold"> Chargeuses > 6t (CACES
                            C1)</span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Engins de chantier TP / Formation CACES R 482 => <span class="bold">Engins de transport
                            (dumper‚Ä¶) > 6t (CACES E)</span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Engins de chantier TP / Formation CACES R 482 => <span class="bold"> Manitou (CACES F) <span
                                class="bold"></span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold"> Conduite Pelles M√©caniques sur pneumatiques </span> (Formation R482 B1 +
                        Exp√©rience demand√©e)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td> <span class="bold">Conduite Pelles sur √©quipements flottants / Pelles amphibies </span>
                        (Formation R482 B1 + Exp√©rience demand√©e)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Engins de Logistique / Formation CACES R 489 => <span class="bold">Chariot El√©vateur (CACES
                            3)</span> </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>Equipements de Levage / Formation CACES R 490 => <span class="bold">Grue Auxiliaire </span>
                    </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Conduite de pousseurs fluviaux </span> (Permis PC + Grille M√©tier Formation
                        au poste)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Conduite de v√©hicule de la soci√©t√© </span> (Permis B)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                </tbody>
            </table>

            <table class="table-right">

                <thead>
                <tr>
                    <th>Autres t√¢ches</th>
                    <th>T√¢che autoris√©e par CDES</th>
                    <th>Attestation de formation valid√©</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td> <span class="bold"> Machine / Outils portatifs dangereux Travaux Divers </span> => Formation au
                        poste + V√©rification des EPI</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Outils portatifs dangereux Travaux Forestiers </span> => Formation + EPI
                        Forestier</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold"> Travaux soumis √† Formation AIPR </span> (r√©seaux‚Ä¶)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Travaux soumis √† Habilitations Electriques </span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Travaux en espace confin√© </span> (CATEC)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td> <span class="bold">Op√©ration de levage / √©lingage </span> (Formation Elingage)</td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td> <span class="bold">Travaux n√©cessitant la formation Travail en Hauteur et Port du Harnais
                        </span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td> <span class="bold">Montage et d√©montage d'ateliers flottants (dragage) / Assemblage de machines
                        </span> (Formation au poste)
                    </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td> <span class="bold">Travaux par points chauds (soudure‚Ä¶)</span> Grille M√©tier Formation au
                        poste
                    </td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold"> Autres t√¢ches soumis aux grilles de formation m√©tier (Faucardage)</span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><span class="bold">Sauveteur Secouriste du Travail</span></td>
                    <td><input type="checkbox"></td>
                    <td><input type="checkbox"></td>
                </tr>
                </tbody>
            </table>
            </div>
        </div>
        <input type="file" id="photo-input" accept="image/* .png" multiple>
        <div id="photo-container"></div>

<div class="form-et-cadre">
  <div class="bloc-textarea">
    <label>Autres formations/habilitations d√©tenues par le collaborateur</label>
    <textarea name="formation-autres"></textarea>
  </div>
        <div class="cas">
            <h2>Dans tous les cas...</h2>
            <div class="icons">
                <img src="stop-icon.png" alt="Stop">
                <img src="check-icon.png" alt="Check">
            </div>
            <table class="checkboxes">
                <th></th>
                <th>Collaborateur inform√©</th>
                <tr>
                    <td>1. Il est strictement interdit d'effectuer les t√¢ches de travail ci-dessous sans formation en
                        cours de validit√© (voir habilitation ou accr√©ditation) et sans Autorisation + Aptitude m√©dicale
                    </td>
                    <td> <input type="checkbox"> </td>
                </tr>
                <tr>
                    <td>2. Si des travaux interdits vous sont demand√©s, vous avez l'obligation d'en informer
                        imm√©diatement votre n+1 et de ne pas y prendre part. </td>
                    <td><input type="checkbox"></td>
                </tr>
                <tr>
                    <td>3. Dans le cas o√π vous en prendriez l'initiative, ce serait sous votre enti√®re responsabilit√©.
                    </td>
                    <td><input type="checkbox"></td>
                </tr>
            </table>
        </div>
</div>        
            <table>
            <thead>
                <tr>
                    <th>
                        FORMATIONS A PREVOIR
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div>
            <h4>Formations √† pr√©voir dans le cadre de l'activit√© du nouvel arrivant : </h4>
            <textarea name="formation-prevue" id="formation-prevue" placeholder=""></textarea>
        </div>
        </td>
        </tr>
            </tbody>
        </table>
        <table class="attestation">
            <thead>
                <tr>
                    <th>
                        ATTESTATION DE NAGE
                    </th>
                </tr>
            </thead>
            <tbody>
                    <tr>
                    <td>
                <img class="nage-img" src="savoir-nager.png" alt="savoir nager">
                <div class="texte">
                    <span>J'atteste sur l'honneur :</span>
                    <div>                    
                        <input type="checkbox">
                        <label>Savoir Nager</label>
                    </div>
                      <div>  
                    <input type="checkbox">
                    <label>Ne pas savoir nager mais souhaite b√©n√©ficier d'une formation compl√©mentaire de natation</label>
                      </div>
                </div>
                            <div class="sign">
              <span class="date">Signature du collaborateur :</span>
              <canvas id="drawingCanvas1" class="signature-canvas"></canvas>
              <button onclick="clearCanvas('drawingCanvas')">üßπ Effacer</button>
            </div>
                </td>
                </tr>
            </tbody>
        </table>
    </div>

    <button class="next-button" onclick="redirectToAutorisationPage()">Suivant</button>

</body>
<script>

    document.addEventListener("DOMContentLoaded", () => {
  const rowsLeft = document.querySelectorAll(".table-left tbody tr");
  const rowsRight = document.querySelectorAll(".table-right tbody tr");
  
  const nbRows = Math.min(rowsLeft.length, rowsRight.length);
  
  for (let i = 0; i < nbRows; i++) {
    // reset height first
    rowsLeft[i].style.height = "";
    rowsRight[i].style.height = "";

    const hLeft = rowsLeft[i].offsetHeight;
    const hRight = rowsRight[i].offsetHeight;
    const maxH = Math.max(hLeft, hRight);
    
    rowsLeft[i].style.height = maxH + "px";
    rowsRight[i].style.height = maxH + "px";
  }
    setupCanvas('drawingCanvas1');
});

    function savePageContent() {
        const page = document.querySelector('#page2');
        const inputs = page.querySelectorAll('input, textarea, select');
    inputs.forEach(input => {
        if (input.type === 'checkbox' || input.type === 'radio') {
            if (input.checked) {
                input.setAttribute('checked', 'checked');
            } else {
                input.removeAttribute('checked');
            }
        } else if (input.tagName.toLowerCase() === 'textarea') {
            input.textContent = input.value; // ‚úÖ valeur √† l'int√©rieur du textarea
        } else {
            input.setAttribute('value', input.value);
        }
    });
        localStorage.setItem('page2Content', document.querySelector('#page2').outerHTML);
    }

    function loadPageContent() {
        // Restaurer le contenu HTML de la page avec les valeurs des champs
        const savedContent = localStorage.getItem('page2Content');
        if (savedContent) {
            document.querySelector('#page2').outerHTML = savedContent;
        }
    }

    function redirectToAutorisationPage() {
        savePageContent();
        window.location.href = 'security.html';
    }

    window.onload = function () {
        loadPageContent();
    }

    window.onbeforeunload = function () {
        savePageContent();
    }

    const photoInput = document.getElementById('photo-input');
    const photoContainer = document.getElementById('photo-container');

    photoInput.addEventListener('change', function () {
        // Vider l'affichage actuel
        photoContainer.innerHTML = '';

        Array.from(this.files).forEach((file, index) => {
            const reader = new FileReader();

            reader.onload = function (e) {
                // Cr√©e un conteneur pour chaque image + bouton
                const imageWrapper = document.createElement('div');
                imageWrapper.style.position = 'relative';
                imageWrapper.style.display = 'inline-block';

                // Image preview
                const img = document.createElement('img');
                img.src = e.target.result;
                img.style.width = '360px';
                img.style.height = 'auto';
                img.style.border = '1px solid #ccc';
                img.style.borderRadius = '8px';

                // Bouton de suppression
                const btn = document.createElement('button');
                btn.textContent = '‚úï';
                btn.style.position = 'absolute';
                btn.style.top = '0';
                btn.style.right = '0';
                btn.style.background = 'rgba(0,0,0,0.6)';
                btn.style.color = 'white';
                btn.style.border = 'none';
                btn.style.borderRadius = '0 8px 0 8px';
                btn.style.cursor = 'pointer';

                btn.addEventListener('click', () => {
                    imageWrapper.remove();
                });

                imageWrapper.appendChild(img);
                imageWrapper.appendChild(btn);
                photoContainer.appendChild(imageWrapper);
            };

            reader.readAsDataURL(file);
        });
    });

      function setupCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    canvas.width = canvas.parentElement.clientWidth;
    canvas.height = canvas.parentElement.clientHeight;

    let painting = false;

    function startPosition(e) {
      painting = true;
      draw(e);
      e.preventDefault(); // Emp√™che le comportement par d√©faut
    }

    function endPosition(e) {
      painting = false;
      ctx.beginPath();
      e.preventDefault(); // Emp√™che le comportement par d√©faut
    }

    function draw(e) {
      if (!painting) return;
      const rect = canvas.getBoundingClientRect();
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';

      let clientX, clientY;
      if (e.touches && e.touches.length > 0) {
        // Utiliser les coordonn√©es du premier touch point
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      } else {
        // Utiliser les coordonn√©es de la souris
        clientX = e.clientX;
        clientY = e.clientY;
      }

      ctx.lineTo(clientX - rect.left, clientY - rect.top);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(clientX - rect.left, clientY - rect.top);
      e.preventDefault(); // Emp√™che le comportement par d√©faut
    }

    // Ajouter des √©couteurs pour les √©v√©nements de souris
    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', endPosition);
    canvas.addEventListener('mouseout', endPosition);
    canvas.addEventListener('mousemove', draw);

    // Ajouter des √©couteurs pour les √©v√©nements tactiles
    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', endPosition);
    canvas.addEventListener('touchcancel', endPosition);
    canvas.addEventListener('touchmove', draw);
  }

  function clearCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
</script>

</html>